<div class="modal fade bd-example-modal-lg" id="branchModal" tabindex="-1" role="dialog" aria-labelledby="branchModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="branchModalLabel">Create branch</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
      	<div class="form-group">
      	   <label for="newBranchDiagram">Diagram title</label>
      	   <input type="text" class="form-control col-6" id="newBranchDiagram" #newBranchTitle value="New diagram">
      	 </div>
      	 <button type="button" class="btn btn-primary mb-2" data-dismiss="modal" (click)="createBranch(newBranchTitle.value, 0)">Create and go to new diagram</button>
      	 <button type="button" class="btn btn-primary mb-2" data-dismiss="modal" (click)="createBranch(newBranchTitle.value, 1)">Create and stay here</button>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>       
      </div>
    </div>
  </div>
</div>
<div id="diagram">
</div>
<div id="tools" class="col-lg-3 col-md-4 col-xs-12 offset-lg-9 offset-md-8" *ngIf="showTools">
	<div class="form-group row" >
		<a (click)="closeTools()" style="font-size: 1.4em; cursor: pointer;"><i class="fa fa-times-circle-o" aria-hidden="true"></i></a>
	</div>
	<!-- Edit Node -->
	<form name="form" (ngSubmit)="saveNode()" *ngIf="showNodeTools">
	  <div class="form-group">
	    <label for="caption">Caption</label>
	    <input type="text" class="form-control" id="caption" [(ngModel)]="currentNode.caption" name="caption">
	  </div>
	  <div class="form-group">
	    <label for="properties">Properties</label>
	    <textarea class="form-control" id="properties" rows="6" [(ngModel)]="currentNode.properties.text" name="properties"></textarea>
	  </div>
	  <div class="form-group">
	  	<div class="btn-group" data-toggle="buttons">
	  	  <label class="btn btn-secondary" [class.active]="!currentNode.isRectangle" (click)="currentNode.isRectangle=false">
	  	    <input type="radio" name="options" id="option1" autocomplete="off"> <i class="fa fa-circle-thin fa-2x" aria-hidden="true"></i>
	  	  </label>
	  	  <label class="btn btn-secondary" [class.active]="currentNode.isRectangle" (click)="currentNode.isRectangle=true">
	  	    <input type="radio" name="options" id="option2" autocomplete="off"> <i class="fa fa-square-o fa-2x" aria-hidden="true"></i>
	  	  </label>
	  	</div>
	  </div>
	  <div class="form-group">
	    <div class="input-group">
	      <span class="input-group-btn">
        	<button class="btn btn-secondary" type="button" [style.color]="currentNode.style.color">Text Color</button>
      	</span>
	      <input type="text" class="form-control" id="text-color" [(ngModel)]="currentNode.style.color" name="textColor">
	    </div>
	  </div>
	  <div class="form-group">
	    <div class="input-group">
	      <span class="input-group-btn">
        	<button class="btn btn-secondary" type="button" [style.background-color]="currentNode.style.fill">Background</button>
      	</span>
	      <input type="text" class="form-control" id="bg-color" [(ngModel)]="currentNode.style.fill" name="bgColor">
	    </div>
	  </div>
	  <div class="form-group">
	  	<button type="button" class="btn btn-danger" (click)="deleteNode()">Delete <i class="fa fa-trash" aria-hidden="true"></i></button>
	  	<button type="submit" class="btn btn-primary float-right">Save <i class="fa fa-check-square-o" aria-hidden="true"></i></button>
	  </div>
	</form>
	<!-- Edit Relationship -->
	<form name="rForm" (ngSubmit)="saveR()" *ngIf="!showNodeTools">
		<div class="form-group">
			<button type="button" class="btn btn-secondary" (click)="reverseR()">Reverse <i class="fa fa-retweet" aria-hidden="true"></i></button>
		</div>
	  <div class="form-group">
	    <label for="caption">Type</label>
	    <input type="text" class="form-control" id="caption" [(ngModel)]="currentR.type" name="type">
	  </div>
	  <div class="form-group">
	    <label for="properties">Properties</label>
	    <textarea class="form-control" id="properties" rows="6" [(ngModel)]="currentR.properties.text" name="properties"></textarea>
	  </div>
	 	<div class="form-group">
	    <div class="input-group">
	      <span class="input-group-btn">
        	<button class="btn btn-secondary" type="button" [style.color]="currentR.style.fill"><i class="fa fa-long-arrow-right" aria-hidden="true"></i></button>
      	</span>
	      <input type="text" class="form-control" id="bg-color" [(ngModel)]="currentR.style.fill" name="fillColor">
	    </div>
	  </div>
	  <div class="form-group">
	  	<button type="button" class="btn btn-danger" (click)="deleteR()">Delete <i class="fa fa-trash" aria-hidden="true"></i></button>
	  	<button type="submit" class="btn btn-primary float-right">Save <i class="fa fa-check-square-o" aria-hidden="true"></i></button>
	  </div>
	</form>
</div>

<div id="diagram-tools" class="btn-group-vertical">
	<button type="button" class="btn btn-secondary btn-tool" (click)="zoomChange(1)"><i class="fa fa-plus" aria-hidden="true"></i></button>
	<button type="button" class="btn btn-secondary btn-tool" (click)="zoomChange(0)"><i class="fa fa-minus" aria-hidden="true"></i></button>
	<button type="button" class="btn btn-secondary btn-tool mt-2 mb-2" (click)="zoomFit()"><i class="fa fa-crosshairs" aria-hidden="true"></i></button>
	<div *ngIf="access!='Read Only'" class="btn-group-vertical">
	  <button type="button" class="btn btn-secondary btn-tool" (click)="nodeLocked=false; removeLocked=false; relLocked=false; mirrorNode.isLocked=!mirrorNode.isLocked;">
	  	<img *ngIf="!mirrorNode.isLocked" src="../assets/img/paintbrush_off.svg">
	  	<img *ngIf="mirrorNode.isLocked" src="../assets/img/paintbrush_on.svg">
	  </button>
		<button type="button" [class]="nodeLocked ? 'btn btn-danger':'btn btn-secondary btn-tool'" (click)="removeLocked=false; mirrorNode.isLocked=false; relLocked=false; nodeLocked=!nodeLocked">
			<i class="fa fa-plus-circle" aria-hidden="true"></i>
		</button>
		<button type="button" [class]="relLocked ? 'btn btn-danger':'btn btn-secondary btn-tool'" (click)="removeLocked=false; mirrorNode.isLocked=false; nodeLocked=false; relLocked=!relLocked;">
			<i class="fa fa-arrows-h" aria-hidden="true"></i>
		</button>
		<button type="button" [class]="removeLocked ? 'btn btn-danger':'btn btn-secondary btn-tool'" (click)="mirrorNode.isLocked=false; nodeLocked=false; relLocked=false; removeLocked=!removeLocked">
			<i class="fa fa-trash-o" aria-hidden="true"></i>
		</button>
	  <div *ngIf="nodeLocked || mirrorNode.isLocked" id="mirrorNode" [style.top]="nodeLocked ? '36px':'0px'" [style.color]="mirrorNode.color" [style.border-radius]="mirrorNode.isRectangle ? '5px':'14px'" [style.background-color]="mirrorNode.fill">
	 	 T
	  </div>
	  <button type="button" class="btn btn-secondary btn-tool mt-2" [disabled]="currentIndex <= 1" (click)="undo()"><i class="fa fa-level-up fa-rotate-270" aria-hidden="true"></i></button>
	  <button type="button" class="btn btn-secondary btn-tool mb-2" [disabled]="currentIndex >= maxIndex" (click)="redo()"><i class="fa fa-level-up fa-rotate-90" aria-hidden="true"></i></button>
	  <button type="button" class="btn btn-secondary btn-tool" (click)="showSlider=!showSlider; slider()"><i class="fa fa-play" aria-hidden="true"></i></button>
	</div>
</div>
<div [hidden]="!showSlider" class="slider" id="slider">
	<div class="">
		<i *ngIf="currentIndex == maxIndex" class="fa fa-repeat" aria-hidden="true" style="display: inline-block; margin-left: 40px; margin-right: 10px;" (click)="playSlides = !playSlides; replaySlider()"></i>
		<i *ngIf="currentIndex != maxIndex" [class]="playSlides ? 'fa fa-pause':'fa fa-play'" aria-hidden="true" style="display: inline-block; margin-left: 40px; margin-right: 10px;" (click)="playSlides = !playSlides; playSlider(1)"></i>
		<small> 
			{{ currentIndex }}/{{ maxIndex }}
			<span class="ml-2">Speed: </span> 
			<input type="range" min="300" max="2000" step="100" value="1300" #speed (change)="speedSlider=speed.value" style="width: 100px;">
		</small>
		<span class="ml-3">
			<i class="fa fa-code-fork" aria-hidden="true" data-toggle="modal" data-target="#branchModal"></i>
		</span>
		<span class="float-right mr-2" (click)="playSlides = !playSlides; playSlider(-1)">
			<i class="fa fa-backward" aria-hidden="true"></i>
		</span>
	</div>
	<svg class="svg-slider" id="svg-slider" >
		<g id="gslider"></g>
	</svg>
</div>